<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:insert="~{partials/reusable :: head}"></th:block>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="/CSS/inscription.css">
</head>

<body>

<header>
    <th:block th:insert="~{partials/reusable :: header}"></th:block>
</header>


<div class="d-flex justify-content-center">
    <div class="centre-vertical" style="min-width: 35vw">
        <div class="card mx-auto b-2 my-2">
            <div class="card-header text-center">
                <h4>Connexion</h4>
            </div>

            <div class="card-body ">
                <form action="#" th:action="@{/connexion}" th:object="${user}" method="POST">
                    <div class="form-group">
                        <label>Email</label>
                        <input id="email" th:field="*{email}" type="email" name="email" class="form-control"
                               placeholder="exemple@gmail.com" required>
                    </div>

                    <label>Mot de passe</label>
                    <div class="form-group visibility_password">

                        <input id="mdp1" th:field="*{password}" type="password" name="password" class="form-control"
                               placeholder="hyper_secure" required>
                        <div class="password-icon">
                                <span class="material-symbols-outlined visibility">
                                    visibility
                                </span>
                            <span class="material-symbols-outlined visililityOff">
                                    visibility_off
                                </span>
                        </div>

                    </div>

                    <div class="text-center mt-4">
                        <button class="btn btn-primary">
                            Se connecter
                        </button>
                    </div>
                    <div class="text-center mt-4">
                        <a href="/user/forgotPassword" class="forgot-password-link">Mot de passe oublié ?</a>
                    </div>
                    <div class="mt-3 alert alert-danger" role="alert" th:if="${invalid == true}">
                        <span>Erreur lors de l'authentification</span>
                    </div>
                    <div class="mt-3 alert alert-danger" role="alert" th:if="${isUser == true}">
                        <span>Vous n'avez pas les droits pour accéder à l'interface d'administration</span>
                    </div>
                    <div class="mt-3 alert alert-danger" role="alert" th:if="${desactivated == true}">
                        <span>Plus de 3 tentatives échouées, votre compte a été désactiver.</span>
                    </div>
                    <div class="mt-3 alert alert-danger" role="alert" th:if="${askAdmin == true}">
                        <span> Veuillez demander à un administrateur de réactiver votre compte.</span>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>

<footer>
    <th:block th:insert="~{partials/reusable :: footer}"></th:block>
</footer>

<script>
    const eye = document.querySelector(".visibility_password .password-icon .visibility");
    const eyeoff = document.querySelector(".visibility_password .password-icon .visililityOff");
    const eye2off = document.querySelector("#visibility2OFF");
    const eye2 = document.querySelector("#visibility2OK");
    const passwordField = document.querySelector("#mdp1");
    const passwordField2 = document.querySelector("#mdp2");
    eye.addEventListener("click", () => {
        eye.style.display = "none";
        eyeoff.style.display = "block";
        passwordField.type = "text";
    });

    eyeoff.addEventListener("click", () => {
        console.log("click");
        eyeoff.style.display = "none";
        eye.style.display = "block";
        passwordField.type = "password";
    });

    eye2.addEventListener("click", () => {
        eye2.style.display = "none";
        eye2off.style.display = "block";
        passwordField2.type = "text";
    });

    eye2off.addEventListener("click", () => {
        console.log("click");
        eye2off.style.display = "none";
        eye2.style.display = "block";
        passwordField2.type = "password";
    });
</script>
</html>